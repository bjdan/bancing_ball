# 躲避球（pygame 教学游戏）— 需求与里程碑

> 面向对象：中学生；目标：用最少的 Python 高级特性完成一个可玩的 pygame 小游戏。
> 代码约束：不使用类与复杂类型标注，尽量用列表、字典、元组、基本函数与常量，结构清晰、注释充分。

## 技术与运行
- 依赖：`python 3.10+`，`pygame`
- 运行（后续实现后）：`python src/main.py`
- 分辨率建议：`800x600`

## 核心玩法
- 控制小人（键盘方向键或 WASD）在屏幕内移动。
- 多个弹球匀速运动，撞到屏幕边界反弹。
- 小人与弹球碰撞：扣除生命值；生命为 0 时游戏结束。
- 存活时间越长，难度越高（弹球数量或速度增加），得分随存活时间与难度提升累计。

## 核心数据结构（规划）
- `player`: 字典，含位置、速度、半径、生命、无敌计时等。
- `balls`: 列表，内含若干元组/字典，记录每个球的 `x, y, vx, vy, r, color`。
- `level`: 字典，记录难度、计时、生成频率、速度上限、最大球数。
- `score`: 整数；`state`: 字符串（"ready" / "playing" / "gameover"）。

## 里程碑（由简到繁）

### M1：弹球基础（无玩家）
- 在屏幕上生成 3–5 个弹球，初始方向、颜色、大小各不相同。
- 弹球以常量速度移动，遇到屏幕边缘发生镜面反弹。
- 完成：窗口、时钟、事件循环、清屏与绘制逻辑。
- 验收：弹球持续运动且无卡顿，窗口可关闭。

### M2：加入玩家小人与基本碰撞
- 使用键盘控制一个方块或其它非圆形小人（与弹球区别明显）。
- 限制小人不离开屏幕边界。
- 与弹球的碰撞检测（圆-矩形近似或精确检测均可）：碰撞时扣除生命值（例如每次 -20）。
- 屏幕左上角显示生命值：数字 + 血条（同时显示）。
- 验收：可操作，碰撞能扣血，生命为 0 时切换到“游戏结束”状态。

### M3：基础 UI 与状态切换
- 三个状态：`ready`（按键开始）、`playing`、`gameover`（按键重开）。
- 屏幕显示：当前分数、最高分（内存记忆即可）、生命值。
- 暂停/恢复（可选）：按 `P` 暂停与继续。
- 验收：状态切换文本清晰、流程顺畅。

### M4：难度与关卡提升
- 随时间推移提高难度：
  - 方案 A：定时新增弹球（直到最大数量）。
  - 方案 B：每隔一段时间提升所有弹球速度上限。
- 根据当前难度每秒增加更多分数（例如基础每秒 1 分，难度每提升一级+0.5）。
- 简单的“关卡/波次”文本提示（如 Level 1、2、3）。
- 验收：可观察到难度逐步提升，分数增长更快。

### M5：视觉与音效（可选）
- 更友好的配色、背景色或简易背景图。
- 播放音效：碰撞（受伤）、升级、开始/结束。
- 验收：不会影响性能，音量适中，可静音开关（按 `M`）。

### M6：打磨与教学注释
- 代码模块化但不使用类：将配置、绘图、碰撞、难度提升等逻辑用函数拆分。
- 在关键函数和数据结构上增加面向学生的解释性注释。
- 在 `docs/` 加入一页“讲解提纲”（可选）。
- 验收：学生读代码能理解主要流程与数据如何变化。

## 评分与结束条件
- 生命值归零：显示“Game Over”与最终分数，可按键重试。
- 分数计算：基于生存时间与难度等级的累计值。
- 最高分记录：本轮进程内的最高分（文件持久化可选）。

## 项目结构（建议）
- `src/main.py`：入口，主循环与状态机。
- `src/config.py`：常量与可调参数（分辨率、颜色、初始球数、速度上限等）。
- `src/game_logic.py`：球运动、碰撞、难度提升相关的函数。
- `assets/`：图片与音效（前期可为空）。
- `docs/requirements.md`：本文档。

## 开放扩展（可选）
- 道具：护盾、加速、回血。
- 不同大小与质量的球（反弹速度变化）。
- 多人模式或 AI 演示。
